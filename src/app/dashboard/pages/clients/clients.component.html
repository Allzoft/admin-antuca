<div class="flex justify-content-between">
  <app-title title="Lista de clientes" />
  <div class="flex gap-3 justify-content-center align-items-center">
    <p-button
      severity="info"
      [outlined]="true"
      [rounded]="true"
      [icon]="
        clientsService.loading()
          ? 'pi pi-spin pi-spinner font-medium text-xl'
          : 'pi pi-refresh font-medium text-xl'
      "
      size="small"
      (onClick)="refreshData()"
    ></p-button>
    <p-button
      severity="success"
      icon="pi pi-user-plus font-medium"
      label="Nuev@ cliente"
      [rounded]="true"
      styleClass="text-sm"
      (onClick)="createClient()"
    ></p-button>
  </div>
</div>
<div class="p-0 border-round">
  <p-table [value]="clients()" styleClass=" p-datatable-sm">
    @if (showFilters) {

    <ng-template pTemplate="caption">
      <div class="flex w-full justify-content-end align-items-center">
        <span class="p-input-icon-left w-full md:w-auto">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            placeholder="Buscar por nombre o número"
            (input)="customGlobalFilter($event)"
            class="focus:border-orange-500 border-round-lg p-inputtext-sm w-full md:w-auto"
          />
        </span>
      </div>
    </ng-template>
    }
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="id_client" class="pl-5 white-space-nowrap">
          ID <p-sortIcon field="id_client" />
        </th>
        <th>Foto</th>
        <th pSortableColumn="name" class="white-space-nowrap">
          Nombre <p-sortIcon field="name" />
        </th>
        <th pSortableColumn="phone" class="white-space-nowrap">
          Teléfono <p-sortIcon field="phone" />
        </th>
        <th>Correo</th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-client>
      <tr>
        <td class="pl-5 ">{{ client.id_client }}</td>
        <td>
          <img
            [src]="client!.photo | image"
            class="border-circle w-2rem h-2rem"
            alt="Profile"
          />
        </td>
        <td>{{ client.name }} {{ client.lastname }}</td>
        <td>{{ client.phone }}</td>
        <td>{{ client.email }}</td>
        <td class="white-space-nowrap">
          <p-button
            icon="pi pi-pencil"
            [rounded]="true"
            [outlined]="true"
            styleClass="h-2rem w-2rem"
            (onClick)="showClient(client)"
          ></p-button>
          <p-button
            icon="pi pi-trash"
            severity="danger"
            [rounded]="true"
            [outlined]="true"
            styleClass="h-2rem w-2rem ml-2"
            (onClick)="deleteClient(client)"
          ></p-button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="footer">
      <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td>{{ "Total: " + clients().length }}</td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="6">No hay clientes registrados</td>
      </tr>
    </ng-template>
  </p-table>
</div>
<p-toast  border-roundposition="top-center"></p-toast>
<p-confirmDialog styleClass="w-auto md:w-5" position="bottom"></p-confirmDialog>
